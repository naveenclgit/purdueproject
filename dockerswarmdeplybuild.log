Started by user Naveen C
Obtained Jenkinsfile from git https://github.com/naveenclgit/purdueproject.git
[Pipeline] Start of Pipeline
[Pipeline] node
Running on Jenkins in /var/lib/jenkins/workspace/purdueproject
[Pipeline] {
[Pipeline] stage
[Pipeline] { (Declarative: Checkout SCM)
[Pipeline] checkout
Selected Git installation does not exist. Using Default
The recommended git tool is: NONE
No credentials specified
 > /usr/bin/git rev-parse --resolve-git-dir /var/lib/jenkins/workspace/purdueproject/.git # timeout=10
Fetching changes from the remote Git repository
 > /usr/bin/git config remote.origin.url https://github.com/naveenclgit/purdueproject.git # timeout=10
Fetching upstream changes from https://github.com/naveenclgit/purdueproject.git
 > /usr/bin/git --version # timeout=10
 > git --version # 'git version 2.39.3'
 > /usr/bin/git fetch --tags --force --progress -- https://github.com/naveenclgit/purdueproject.git +refs/heads/*:refs/remotes/origin/* # timeout=10
 > /usr/bin/git rev-parse refs/remotes/origin/master^{commit} # timeout=10
Checking out Revision 5b3fe99c67b9f3dadc12fd6e7f0e88568fceb91c (refs/remotes/origin/master)
 > /usr/bin/git config core.sparsecheckout # timeout=10
 > /usr/bin/git checkout -f 5b3fe99c67b9f3dadc12fd6e7f0e88568fceb91c # timeout=10
Commit message: "Jenkinsfile updated V"
 > /usr/bin/git rev-list --no-walk 5b3fe99c67b9f3dadc12fd6e7f0e88568fceb91c # timeout=10
[Pipeline] }
[Pipeline] // stage
[Pipeline] withEnv
[Pipeline] {
[Pipeline] stage
[Pipeline] { (Code Checkout)
[Pipeline] git
Selected Git installation does not exist. Using Default
The recommended git tool is: NONE
No credentials specified
 > /usr/bin/git rev-parse --resolve-git-dir /var/lib/jenkins/workspace/purdueproject/.git # timeout=10
Fetching changes from the remote Git repository
 > /usr/bin/git config remote.origin.url https://github.com/naveenclgit/purdueproject.git # timeout=10
Fetching upstream changes from https://github.com/naveenclgit/purdueproject.git
 > /usr/bin/git --version # timeout=10
 > git --version # 'git version 2.39.3'
 > /usr/bin/git fetch --tags --force --progress -- https://github.com/naveenclgit/purdueproject.git +refs/heads/*:refs/remotes/origin/* # timeout=10
 > /usr/bin/git rev-parse refs/remotes/origin/master^{commit} # timeout=10
Checking out Revision 5b3fe99c67b9f3dadc12fd6e7f0e88568fceb91c (refs/remotes/origin/master)
 > /usr/bin/git config core.sparsecheckout # timeout=10
 > /usr/bin/git checkout -f 5b3fe99c67b9f3dadc12fd6e7f0e88568fceb91c # timeout=10
 > /usr/bin/git branch -a -v --no-abbrev # timeout=10
 > /usr/bin/git branch -D master # timeout=10
 > /usr/bin/git checkout -b master 5b3fe99c67b9f3dadc12fd6e7f0e88568fceb91c # timeout=10
Commit message: "Jenkinsfile updated V"
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Code Compile)
[Pipeline] sh
+ mvn compile
[INFO] Scanning for projects...
[INFO] 
[INFO] ----------------------< com.abc:ABCtechnologies >-----------------------
[INFO] Building RetailModule 1.0
[INFO] --------------------------------[ war ]---------------------------------
[INFO] 
[INFO] --- jacoco-maven-plugin:0.8.6:prepare-agent (jacoco-initialize) @ ABCtechnologies ---
[INFO] argLine set to -javaagent:/var/lib/jenkins/.m2/repository/org/jacoco/org.jacoco.agent/0.8.6/org.jacoco.agent-0.8.6-runtime.jar=destfile=/var/lib/jenkins/workspace/purdueproject/target/jacoco.exec
[INFO] 
[INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ ABCtechnologies ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] skip non existing resourceDirectory /var/lib/jenkins/workspace/purdueproject/src/main/resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.1:compile (default-compile) @ ABCtechnologies ---
[INFO] Nothing to compile - all classes are up to date
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  1.319 s
[INFO] Finished at: 2024-07-31T08:47:26Z
[INFO] ------------------------------------------------------------------------
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Unit Test)
[Pipeline] sh
+ mvn test
[INFO] Scanning for projects...
[INFO] 
[INFO] ----------------------< com.abc:ABCtechnologies >-----------------------
[INFO] Building RetailModule 1.0
[INFO] --------------------------------[ war ]---------------------------------
[INFO] 
[INFO] --- jacoco-maven-plugin:0.8.6:prepare-agent (jacoco-initialize) @ ABCtechnologies ---
[INFO] argLine set to -javaagent:/var/lib/jenkins/.m2/repository/org/jacoco/org.jacoco.agent/0.8.6/org.jacoco.agent-0.8.6-runtime.jar=destfile=/var/lib/jenkins/workspace/purdueproject/target/jacoco.exec
[INFO] 
[INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ ABCtechnologies ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] skip non existing resourceDirectory /var/lib/jenkins/workspace/purdueproject/src/main/resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.1:compile (default-compile) @ ABCtechnologies ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ ABCtechnologies ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] skip non existing resourceDirectory /var/lib/jenkins/workspace/purdueproject/src/test/resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.1:testCompile (default-testCompile) @ ABCtechnologies ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- maven-surefire-plugin:2.12.4:test (default-test) @ ABCtechnologies ---
[INFO] Surefire report directory: /var/lib/jenkins/workspace/purdueproject/target/surefire-reports

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running com.abc.dataAccessObject.ProductImpTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.043 sec

Results :

Tests run: 4, Failures: 0, Errors: 0, Skipped: 0

[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  2.132 s
[INFO] Finished at: 2024-07-31T08:47:30Z
[INFO] ------------------------------------------------------------------------
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Code Packaging)
[Pipeline] sh
+ mvn package
[INFO] Scanning for projects...
[INFO] 
[INFO] ----------------------< com.abc:ABCtechnologies >-----------------------
[INFO] Building RetailModule 1.0
[INFO] --------------------------------[ war ]---------------------------------
[INFO] 
[INFO] --- jacoco-maven-plugin:0.8.6:prepare-agent (jacoco-initialize) @ ABCtechnologies ---
[INFO] argLine set to -javaagent:/var/lib/jenkins/.m2/repository/org/jacoco/org.jacoco.agent/0.8.6/org.jacoco.agent-0.8.6-runtime.jar=destfile=/var/lib/jenkins/workspace/purdueproject/target/jacoco.exec
[INFO] 
[INFO] --- maven-resources-plugin:2.6:resources (default-resources) @ ABCtechnologies ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] skip non existing resourceDirectory /var/lib/jenkins/workspace/purdueproject/src/main/resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.1:compile (default-compile) @ ABCtechnologies ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- maven-resources-plugin:2.6:testResources (default-testResources) @ ABCtechnologies ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] skip non existing resourceDirectory /var/lib/jenkins/workspace/purdueproject/src/test/resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.1:testCompile (default-testCompile) @ ABCtechnologies ---
[INFO] Nothing to compile - all classes are up to date
[INFO] 
[INFO] --- maven-surefire-plugin:2.12.4:test (default-test) @ ABCtechnologies ---
[INFO] Surefire report directory: /var/lib/jenkins/workspace/purdueproject/target/surefire-reports

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running com.abc.dataAccessObject.ProductImpTest
Tests run: 4, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.04 sec

Results :

Tests run: 4, Failures: 0, Errors: 0, Skipped: 0

[INFO] 
[INFO] --- maven-war-plugin:3.2.2:war (default-war) @ ABCtechnologies ---
[INFO] Packaging webapp
[INFO] Assembling webapp [ABCtechnologies] in [/var/lib/jenkins/workspace/purdueproject/target/ABCtechnologies-1.0]
[INFO] Processing war project
[INFO] Copying webapp resources [/var/lib/jenkins/workspace/purdueproject/src/main/webapp]
[INFO] Webapp assembled in [123 msecs]
[INFO] Building war: /var/lib/jenkins/workspace/purdueproject/target/ABCtechnologies-1.0.war
[INFO] 
[INFO] --- jacoco-maven-plugin:0.8.6:report (jacoco-site) @ ABCtechnologies ---
[INFO] Loading execution data file /var/lib/jenkins/workspace/purdueproject/target/jacoco.exec
[INFO] Analyzed bundle 'RetailModule' with 2 classes
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  4.275 s
[INFO] Finished at: 2024-07-31T08:47:38Z
[INFO] ------------------------------------------------------------------------
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Build Docker Image)
[Pipeline] sh
+ cp /var/lib/jenkins/workspace/purdueproject/target/ABCtechnologies-1.0.war /var/lib/jenkins/workspace/purdueproject/abc.war
[Pipeline] sh
+ docker build -t purdueproject:9 .
#0 building with "default" instance using docker driver

#1 [internal] load build definition from Dockerfile
#1 transferring dockerfile: 477B done
#1 DONE 0.0s

#2 [internal] load metadata for docker.io/library/tomcat:latest
#2 DONE 0.8s

#3 [internal] load .dockerignore
#3 transferring context: 2B done
#3 DONE 0.0s

#4 [1/2] FROM docker.io/library/tomcat:latest@sha256:550f9e9c14b9424e79cd67179613bb3b718cf22de2167d6c4226be3a67db5f2d
#4 DONE 0.0s

#5 [internal] load build context
#5 transferring context: 7.13MB 0.2s done
#5 DONE 0.2s

#4 [1/2] FROM docker.io/library/tomcat:latest@sha256:550f9e9c14b9424e79cd67179613bb3b718cf22de2167d6c4226be3a67db5f2d
#4 CACHED

#6 [2/2] COPY abc.war /usr/local/tomcat/webapps/
#6 DONE 0.7s

#7 exporting to image
#7 exporting layers
#7 exporting layers 1.7s done
#7 writing image sha256:b62b67b98bf06431e6d9edae63dbe74de5a04d45de9e4a07670bb8857645076f done
#7 naming to docker.io/library/purdueproject:9 done
#7 DONE 1.7s
[Pipeline] sh
+ docker tag purdueproject:9 jsachdev07/purdueproject:9
[Pipeline] script
[Pipeline] {
[Pipeline] isUnix
[Pipeline] withEnv
[Pipeline] {
[Pipeline] sh
+ docker build -t naveencldock/purdueproject .
#0 building with "default" instance using docker driver

#1 [internal] load build definition from Dockerfile
#1 transferring dockerfile: 477B done
#1 DONE 0.0s

#2 [internal] load metadata for docker.io/library/tomcat:latest
#2 DONE 0.1s

#3 [internal] load .dockerignore
#3 transferring context: 2B done
#3 DONE 0.0s

#4 [1/2] FROM docker.io/library/tomcat:latest@sha256:550f9e9c14b9424e79cd67179613bb3b718cf22de2167d6c4226be3a67db5f2d
#4 DONE 0.0s

#5 [internal] load build context
#5 transferring context: 84B done
#5 DONE 0.0s

#6 [2/2] COPY abc.war /usr/local/tomcat/webapps/
#6 CACHED

#7 exporting to image
#7 exporting layers done
#7 writing image sha256:b62b67b98bf06431e6d9edae63dbe74de5a04d45de9e4a07670bb8857645076f done
#7 naming to docker.io/naveencldock/purdueproject done
#7 DONE 0.0s
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // script
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Test Docker Image)
[Pipeline] script
[Pipeline] {
[Pipeline] isUnix
[Pipeline] withEnv
[Pipeline] {
[Pipeline] sh
+ docker inspect -f . naveencldock/purdueproject
.
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] withDockerContainer
Jenkins does not seem to be running inside a container
$ docker run -t -d -u 988:988 -w /var/lib/jenkins/workspace/purdueproject -v /var/lib/jenkins/workspace/purdueproject:/var/lib/jenkins/workspace/purdueproject:rw,z -v /var/lib/jenkins/workspace/purdueproject@tmp:/var/lib/jenkins/workspace/purdueproject@tmp:rw,z -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** -e ******** naveencldock/purdueproject cat
$ docker top 7dbc7fd90a317dffa96958449026aa62badf426e76ce8b8e54f6fa17dc9cc831 -eo pid,comm
[Pipeline] {
[Pipeline] sh
+ echo Tests passed
Tests passed
[Pipeline] }
$ docker stop --time=1 7dbc7fd90a317dffa96958449026aa62badf426e76ce8b8e54f6fa17dc9cc831
$ docker rm -f --volumes 7dbc7fd90a317dffa96958449026aa62badf426e76ce8b8e54f6fa17dc9cc831
[Pipeline] // withDockerContainer
[Pipeline] }
[Pipeline] // script
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Push Image)
[Pipeline] script
[Pipeline] {
[Pipeline] withEnv
[Pipeline] {
[Pipeline] withDockerRegistry
$ docker login -u naveencldock -p ******** https://registry.hub.docker.com
WARNING! Using --password via the CLI is insecure. Use --password-stdin.
WARNING! Your password will be stored unencrypted in /var/lib/jenkins/workspace/purdueproject@tmp/89adafe6-506b-4078-8035-c9322b0eb7bc/config.json.
Configure a credential helper to remove this warning. See
https://docs.docker.com/engine/reference/commandline/login/#credentials-store

Login Succeeded
[Pipeline] {
[Pipeline] isUnix
[Pipeline] withEnv
[Pipeline] {
[Pipeline] sh
+ docker tag naveencldock/purdueproject registry.hub.docker.com/naveencldock/purdueproject:9
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] isUnix
[Pipeline] withEnv
[Pipeline] {
[Pipeline] sh
+ docker push registry.hub.docker.com/naveencldock/purdueproject:9
The push refers to repository [registry.hub.docker.com/naveencldock/purdueproject]
7ffa4949d21d: Preparing
5f70bf18a086: Preparing
1e02aa201cee: Preparing
5f70bf18a086: Preparing
1c9fbc727242: Preparing
8c898876677c: Preparing
d6843b9cd847: Preparing
c72ec1f3fa99: Preparing
25224a50eec4: Preparing
a30a5965a4f7: Preparing
d6843b9cd847: Waiting
c72ec1f3fa99: Waiting
25224a50eec4: Waiting
a30a5965a4f7: Waiting
5f70bf18a086: Layer already exists
8c898876677c: Layer already exists
1c9fbc727242: Layer already exists
1e02aa201cee: Layer already exists
d6843b9cd847: Layer already exists
c72ec1f3fa99: Layer already exists
a30a5965a4f7: Layer already exists
25224a50eec4: Layer already exists
7ffa4949d21d: Pushed
9: digest: sha256:5032a617c54c5b3c376802dcc92c9c538a4602c2da184c5b21ee4c665f73b780 size: 2412
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] isUnix
[Pipeline] withEnv
[Pipeline] {
[Pipeline] sh
+ docker tag naveencldock/purdueproject registry.hub.docker.com/naveencldock/purdueproject:latest
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] isUnix
[Pipeline] withEnv
[Pipeline] {
[Pipeline] sh
+ docker push registry.hub.docker.com/naveencldock/purdueproject:latest
The push refers to repository [registry.hub.docker.com/naveencldock/purdueproject]
7ffa4949d21d: Preparing
5f70bf18a086: Preparing
1e02aa201cee: Preparing
5f70bf18a086: Preparing
1c9fbc727242: Preparing
8c898876677c: Preparing
d6843b9cd847: Preparing
c72ec1f3fa99: Preparing
25224a50eec4: Preparing
a30a5965a4f7: Preparing
c72ec1f3fa99: Waiting
25224a50eec4: Waiting
a30a5965a4f7: Waiting
d6843b9cd847: Waiting
1e02aa201cee: Layer already exists
1c9fbc727242: Layer already exists
7ffa4949d21d: Layer already exists
8c898876677c: Layer already exists
5f70bf18a086: Layer already exists
c72ec1f3fa99: Layer already exists
d6843b9cd847: Layer already exists
a30a5965a4f7: Layer already exists
25224a50eec4: Layer already exists
latest: digest: sha256:5032a617c54c5b3c376802dcc92c9c538a4602c2da184c5b21ee4c665f73b780 size: 2412
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // withDockerRegistry
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // script
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Deploy to Docker Swarm)
[Pipeline] sshagent
[ssh-agent] Using credentials root (docker swarm leader)
[ssh-agent] Looking for ssh-agent implementation...
[ssh-agent]   Exec ssh-agent (binary ssh-agent on a remote machine)
$ ssh-agent
SSH_AUTH_SOCK=/tmp/ssh-XXXXXXCH1xb6/agent.52319
SSH_AGENT_PID=52322
Running ssh-add (command line suppressed)
Identity added: /var/lib/jenkins/workspace/purdueproject@tmp/private_key_13986477648920076948.key (jenkins@kvmsysoel900)
[ssh-agent] Started.
[Pipeline] {
[Pipeline] sh
+ ssh -o StrictHostKeyChecking=no -l root 10.0.0.79 'docker service rm purdueproject; docker service create --name purdueproject --mode global --publish published=8282,target=8080,mode=host naveencldock/purdueproject'
purdueproject
2qqv0cllgy7qgwfrc9fxdjel1
overall progress: waiting for new tasks
overall progress: 0 out of 11 tasks
ol8hdpzdlkvg: host-mode port already in use on 1 node
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 0 out of 11 tasks
overall progress: 2 out of 11 tasks
overall progress: 2 out of 11 tasks
overall progress: 3 out of 11 tasks
overall progress: 4 out of 11 tasks
overall progress: 5 out of 11 tasks
overall progress: 9 out of 11 tasks
overall progress: 11 out of 11 tasks
verify: Waiting 5 seconds to verify that tasks are stable...
verify: Waiting 5 seconds to verify that tasks are stable...
verify: Waiting 5 seconds to verify that tasks are stable...
verify: Waiting 5 seconds to verify that tasks are stable...
verify: Waiting 5 seconds to verify that tasks are stable...
verify: Waiting 4 seconds to verify that tasks are stable...
verify: Waiting 4 seconds to verify that tasks are stable...
verify: Waiting 4 seconds to verify that tasks are stable...
verify: Waiting 4 seconds to verify that tasks are stable...
verify: Waiting 4 seconds to verify that tasks are stable...
verify: Waiting 3 seconds to verify that tasks are stable...
verify: Waiting 3 seconds to verify that tasks are stable...
verify: Waiting 3 seconds to verify that tasks are stable...
verify: Waiting 3 seconds to verify that tasks are stable...
verify: Waiting 3 seconds to verify that tasks are stable...
verify: Waiting 2 seconds to verify that tasks are stable...
verify: Waiting 2 seconds to verify that tasks are stable...
verify: Waiting 2 seconds to verify that tasks are stable...
verify: Waiting 2 seconds to verify that tasks are stable...
verify: Waiting 1 seconds to verify that tasks are stable...
verify: Waiting 1 seconds to verify that tasks are stable...
verify: Waiting 1 seconds to verify that tasks are stable...
verify: Waiting 1 seconds to verify that tasks are stable...
verify: Waiting 1 seconds to verify that tasks are stable...
verify: Service converged
[Pipeline] }
$ ssh-agent -k
unset SSH_AUTH_SOCK;
unset SSH_AGENT_PID;
echo Agent pid 52322 killed;
[ssh-agent] Stopped.
[Pipeline] // sshagent
[Pipeline] }
[Pipeline] // stage
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // node
[Pipeline] End of Pipeline
Finished: SUCCESS


